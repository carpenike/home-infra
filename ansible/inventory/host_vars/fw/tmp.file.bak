fw_policies:
    mgmt:
        ipv4:
            - name: mgmt_to_cameras_ipv4
              zones:
                from: mgmt
                to: cameras
              rules:
                - protocol: tcp
                  port: http
                  log: enable
                  action: accept
                - protocol: tcp
                  port: https
                  log: enable
                  action: accept
                - protocol: tcp
                  desc: RTSP
                  port: 554
                  log: enable
                  action: accept
                - protocol: icmp
                  action: accept
                - protocol: all
                  log: enable
                  action: reject
            - name: mgmt_to_local_ipv4
              zones:
                from: mgmt
                to: local
              rules:
                - protocol: udp
                  port: 67
                  log: enable
                  action: accept
                - protocol: tcp
                  port: 22
                  log: enable
                  action: accept
                - protocol: tcp_udp
                  port: 53
                  log: enable
                  action: accept
                - protocol: udp
                  port: 161
                  log: enable
                  action: accept
                - protocol: udp
                  port: 55555
                  desc: Resilio Sync
                  log: enable
                  action: accept
                - protocol: tcp
                  port: 9273
                  desc: Telegraf
                  log: enable
                  action: accept
                - protocol: tcp
                  port: 9100
                  desc: node-exporter
                  log: enable
                  action: accept
                - protocol: udp
                  port: 123
                  desc: NTP Traffic
                  log: enable
                  action: accept
                - protocol: all
                  log: enable
                  action: reject
            - name: mgmt_to_servers_ipv4
              zones:
                from: mgmt
                to: servers
              rules:
                - protocol: tcp
                  port: 22
                  log: enable
                  action: accept
                - protocol: tcp_udp
                  port: 53
                  log: enable
                  action: accept
                - protocol: tcp
                  port: 853
                  log: enable
                  action: accept
                - protocol: tcp
                  port: http
                  log: enable
                  action: accept
                - protocol: tcp
                  port: https
                  log: enable
                  action: accept
                - protocol: tcp
                  port: 1883
                  log: enable
                  action: accept
                - dest_groups: k8s-plex-v4
                  protocol: tcp
                  port: 32400
                  log: enable
                  action: accept
                - dest_groups: k8s-plex-v4
                  protocol: udp
                  port: 1900
                  log: enable
                  action: accept
                - dest_groups: k8s-plex-v4
                  protocol: udp
                  port: 5353
                  log: enable
                  action: accept
                - dest_groups: k8s-plex-v4
                  protocol: udp
                  port: 8324
                  log: enable
                  action: accept
                - dest_groups: k8s-plex-v4
                  protocol: tcp
                  port: 5353
                  log: enable
                  action: accept
                - dest_groups: k8s-plex-v4
                  protocol: udp
                  port: 32410,32412,32413,32414
                  log: enable
                  action: accept
                - dest_groups: k8s-plex-v4
                  protocol: tcp
                  port: 32469
                  log: enable
                  action: accept
                - protocol: tcp
                  port: 6443
                  log: enable
                  action: accept
                - protocol: tcp
                  desc: Unifi-Controller
                  port: 8080
                  log: enable
                  action: accept
                - protocol: udp
                  desc: Unifi-Discovery
                  port: 10001
                  log: enable
                  action: accept
                - protocol: tcp
                  desc: Unifi-Speedtest
                  port: 6789
                  log: enable
                  action: accept
                - protocol: udp
                  desc: Unifi-STUN
                  port: 3478
                  log: enable
                  action: accept
                - protocol: tcp
                  port: 30435
                  desc: VNC
                  log: enable
                  action: accept
                - dest_groups: nas-v4
                  protocol: tcp
                  desc: NFS TCP
                  port: 111,2049
                  log: enable
                  action: accept
                - dest_groups: nas-v4
                  protocol: udp
                  desc: NFS UDP
                  port: 111,2049
                  log: enable
                  action: accept
                - protocol: tcp
                  port: 9000
                  desc: minio
                  log: enable
                  action: accept
                - protocol: icmp
                  log: enable
                  action: accept
                - protocol: all
                  log: enable
                  action: reject
            - name: mgmt_to_wan_ipv4
              zones:
                from: mgmt
                to: wan
              rules:
                - protocol: tcp
                  port: http
                  log: enable
                  action: accept
                - protocol: tcp
                  port: https
                  log: enable
                  action: accept
                - protocol: tcp
                  port: ssh
                  log: enable
                  action: accept
                - protocol: tcp
                  port: 6697
                  desc: IRC
                  log: enable
                  action: accept
                - protocol: tcp
                  port: 49443
                  desc: ADFS
                  log: enable
                  action: accept
                - protocol: udp
                  port: 50000-65535
                  desc: WebRTC (Discord)
                  log: enable
                  action: accept
                - dest_groups: resilio-sync-trackers
                  # source_groups: k8s-resilio-sync-v4
                  desc: Resilio-Sync Trackers
                  protocol: tcp_udp
                  port: 4000
                  log: enable
                  action: accept
                - dest_groups: resilio-sync-relays
                  # source_groups: k8s-resilio-sync-v4
                  desc: Resilio-Sync Relays
                  protocol: tcp_udp
                  port: 3000,3001
                  log: enable
                  action: accept
                - protocol: icmp
                  log: enable
                  action: accept
                - protocol: all
                  log: enable
                  action: reject
            - name: mgmt_to_wireless_ipv4
              zones:
                from: mgmt
                to: wireless
              rules:
                - protocol: tcp
                  port: http
                  log: enable
                  action: accept
                - protocol: tcp
                  port: https
                  log: enable
                  action: accept
                - protocol: tcp
                  port: ssh
                  log: enable
                  action: accept
                - protocol: all
                  log: enable
                  action: reject
    ipv4:
        - name: cameras_to_wan_ipv4
          zones:
            from: cameras
            to: wan
          rules:
            - protocol: all
              log: enable
              action: reject
        - name: cameras_to_local_ipv4
          zones:
            from: cameras
            to: local
          rules:
            - protocol: udp
              port: 67
              log: enable
              action: accept
            - protocol: udp
              desc: NTP Traffic
              port: 123
              log: enable
              action: accept
            - protocol: all
              log: enable
              action: reject
        - name: local_to_servers_ipv4
          zones:
            from: local
            to: servers
          rules:
            - dest_groups: k8s-bgp-peers-v4
              protocol: tcp
              port: 179
              log: enable
              action: accept
            - protocol: tcp_udp
              port: 53
              log: enable
              action: accept
            - protocol: udp
              port: 5353
              log: enable
              action: accept
            - protocol: tcp
              port: 6443
              log: enable
              action: accept
            - dest_groups: k8s-syslog-v4
              protocol: tcp_udp
              port: 1514
              log: enable
              action: accept
            - protocol: icmp
              log: enable
              action: accept
            - protocol: all
              log: enable
              action: reject
        - name: local_to_wireless_ipv4
          zones:
            from: local
            to: wireless
          rules:
            - protocol: udp
              port: 5353
              log: enable
              action: accept
            - protocol: icmp
              log: enable
              action: accept
            - protocol: all
              log: enable
              action: reject
        - name: local_to_wan_ipv4
          zones:
            from: local
            to: wan
          rules:
            - protocol: icmp
              log: enable
              action: accept
            - dest_groups: public-dns-services-v4
              protocol: tcp_udp
              port: 853
              log: enable
              action: accept
            - dest_groups: racknerd-v4
              protocol: udp
              port: 51820
              log: enable
              action: accept
            - protocol: udp
              desc: NTP
              port: 123
              log: enable
              action: accept
            - protocol: tcp
              desc: https
              port: https
              log: enable
              action: accept
            - protocol: all
              log: enable
              action: reject
        - name: servers_to_cameras_ipv4
          zones:
            from: servers
            to: cameras
          rules:
            - protocol: tcp
              port: http
              log: enable
              action: accept
            - protocol: tcp
              port: https
              log: enable
              action: accept
            - protocol: tcp
              port: 554
              log: enable
              action: accept
            - protocol: icmp
              log: enable
              action: accept
            - protocol: all
              log: enable
              action: reject
        - name: servers_to_local_ipv4
          zones:
            from: servers
            to: local
          rules:
            - source_groups: k8s-bgp-peers-v4
              protocol: tcp
              port: 179
              log: enable
              action: accept
            - protocol: tcp_udp
              port: 53
              log: enable
              action: accept
            - protocol: udp
              port: 5353
              log: enable
              action: accept
            - protocol: tcp
              desc: node-exporter
              port: 9100
              log: enable
              action: accept
            - protocol: udp
              port: 123
              desc: NTP Traffic
              log: enable
              action: accept
            - protocol: icmp
              log: enable
              action: accept
            - protocol: all
              log: enable
              action: reject
        - name: servers_to_mgmt_ipv4
          zones:
            from: servers
            to: mgmt
          rules:
            - protocol: icmp
              log: enable
              action: accept
            - protocol: udp
              port: 161
              log: enable
              action: accept
            - protocol: all
              log: enable
              action: reject
        - name: servers_to_wireless_ipv4
          zones:
            from: servers
            to: wireless
          rules:
            - protocol: tcp
              port: 3232
              log: enable
              action: accept
            - protocol: tcp
              port: 6053
              log: enable
              action: accept
            - protocol: tcp
              port: 8266
              log: enable
              action: accept
            - protocol: tcp
              port: 631
              log: enable
              action: accept
            - protocol: tcp_udp
              port: 1400
              log: enable
              action: accept
            - protocol: tcp_udp
              port: 5555
              log: enable
              action: accept
            - protocol: tcp
              port: 8008-8009
              log: enable
              action: accept
            - protocol: udp
              port: 1901
              log: enable
              action: accept
            - protocol: udp
              port: 30000-61000
              log: enable
              action: accept
            - protocol: tcp
              port: 8443
              log: enable
              action: accept
            - protocol: tcp
              port: 3401
              log: enable
              action: accept
            - protocol: tcp
              port: 30000-60000
              log: enable
              action: accept
            - protocol: tcp
              port: 3000
              log: enable
              action: accept
            - protocol: tcp
              port: 9999
              log: enable
              action: accept
            - protocol: icmp
              log: enable
              action: accept
            - protocol: all
              log: enable
              action: reject
        - name: servers_to_wan_ipv4
          zones:
            from: servers
            to: wan
          rules:
            - protocol: tcp
              port: http
              log: enable
              action: accept
            - protocol: tcp
              port: https
              log: enable
              action: accept
            - protocol: udp
              desc: NTP
              port: 123
              log: enable
              action: accept
            - protocol: tcp
              desc: SMTP (Mailgun)
              port: 465
              log: enable
              action: accept
            - protocol: udp
              desc: Wireguard
              port: 51820
              log: enable
              action: accept
            - dest_groups: public-dns-services-v4
              protocol: tcp_udp
              port: 53
              log: enable
              action: accept
            - protocol: tcp
              desc: Usenet
              port: 563
              log: enable
              action: accept
            - protocol: udp
              desc: Unifi-STUN
              port: 3478
              log: enable
              action: accept
            - protocol: tcp
              desc: Unifi-RA
              port: 8883
              log: enable
              action: accept
            - protocol: udp
              desc: Unifi-RA
              port: 443
              log: enable
              action: accept
            - dest_groups: resilio-sync-trackers
              # source_groups: k8s-resilio-sync-v4
              desc: Resilio-Sync Trackers
              protocol: tcp_udp
              port: 4000
              log: enable
              action: accept
            - dest_groups: resilio-sync-relays
              # source_groups: k8s-resilio-sync-v4
              desc: Resilio-Sync Relays
              protocol: tcp_udp
              port: 3000,3001
              log: enable
              action: accept
            - protocol: icmp
              log: enable
              action: accept
            - protocol: all
              log: enable
              action: reject
        - name: wan_to_local_ipv4
          zones:
            from: wan
            to: local
          rules:
            - protocol: icmp
              log: enable
              action: accept
            - source_groups: racknerd-v4
              protocol: udp
              port: 51820
              log: enable
              action: accept
            - protocol: all
              log: enable
              action: reject
        - name: wan_to_servers_ipv4
          zones:
            from: wan
            to: servers
          rules:
            - dest_groups: k8s-plex-v4
              protocol: tcp
              port: 32400
              log: enable
              action: accept
            - dest_groups: k8s-ingress-v4
              protocol: tcp
              port: http
              log: enable
              action: accept
            - dest_groups: k8s-ingress-v4
              protocol: tcp
              port: https
              log: enable
              action: accept
            - dest_groups: k8s-qbittorrent-v4
              protocol: tcp
              port: 50413
              log: enable
              action: accept
            - dest_groups: k8s-resilio-sync-v4
              protocol: tcp
              desc: resilio-sync
              port: 55555-55556
              log: enable
              action: accept
            - protocol: all
              log: enable
              action: reject
        - name: wireless_to_local_ipv4
          zones:
            from: wireless
            to: local
          rules:
            - protocol: udp
              port: 67
              log: enable
              action: accept
            - protocol: udp
              port: 5353
              log: enable
              action: accept
            - protocol: tcp
              port: 22
              log: enable
              action: accept
            - protocol: tcp_udp
              port: 53
              log: enable
              action: accept
            - protocol: udp
              port: 161
              log: enable
              action: accept
            - protocol: udp
              port: 123
              desc: NTP Traffic
              log: enable
              action: accept
            - protocol: all
              log: enable
              action: reject
        - name: wireless_to_servers_ipv4
          zones:
            from: wireless
            to: servers
          rules:
            - protocol: tcp_udp
              port: 53
              log: enable
              action: accept
            - protocol: tcp
              port: 853
              log: enable
              action: accept
            - protocol: tcp_udp
              port: 1400
              log: enable
              action: accept
            - protocol: tcp
              port: 21063
              log: enable
              action: accept
            # - dest_groups: k8s-plex-v4
            #   protocol: tcp
            #   port: 32400
            #   log: enable
            #   action: accept
            # - dest_groups: k8s-plex-v4
            #   protocol: udp
            #   port: 1900
            #   log: enable
            #   action: accept
            # - dest_groups: k8s-plex-v4
            #   protocol: udp
            #   port: 5353
            #   log: enable
            #   action: accept
            # - dest_groups: k8s-plex-v4
            #   protocol: udp
            #   port: 8324
            #   log: enable
            #   action: accept
            # - dest_groups: k8s-plex-v4
            #   protocol: tcp
            #   port: 5353
            #   log: enable
            #   action: accept
            # - dest_groups: k8s-plex-v4
            #   protocol: udp
            #   port: 32410,32412,32413,32414
            #   log: enable
            #   action: accept
            # - dest_groups: k8s-plex-v4
            #   protocol: tcp
            #   port: 32469
            #   log: enable
            #   action: accept
            # - dest_groups: k8s-ingress-v4
            #   protocol: tcp
            #   port: http
            #   log: enable
            #   action: accept
            # - dest_groups: k8s-ingress-v4
            #   protocol: tcp
            #   port: https
            #   log: enable
            #   action: accept
            - dest_groups: nas-v4
              desc: Samba UDP
              protocol: udp
              port: 138,139
              log: enable
              action: accept
            - dest_groups: nas-v4
              protocol: tcp
              desc: Samba TCP
              port: 139,445
              log: enable
              action: accept
            - protocol: tcp
              port: 55555-55556
              desc: resilio-sync
              log: enable
              action: accept
            - protocol: tcp
              port: 8888-8889
              desc: resilio-sync-control
              log: enable
              action: accept
            - protocol: icmp
              log: enable
              action: accept
            - protocol: all
              log: enable
              action: reject
        - name: wireless_to_wan_ipv4
          zones:
            from: wireless
            to: wan
          rules:
            - protocol: tcp_udp
              port: 80
              log: enable
              action: accept
            - protocol: tcp_udp
              port: 443
              log: enable
              action: accept
            - protocol: tcp_udp
              desc: Android Play Store
              port: 5228
              log: enable
              action: accept
            - protocol: udp
              desc: NTP
              port: 123
              log: enable
              action: accept
            - protocol: udp
              desc: Verizon WiFi Calling
              port: 500,4500
              log: enable
              action: accept
            - protocol: tcp
              port: 49443
              desc: ADFS
              log: enable
              action: accept
            - protocol: udp
              port: 50000-65535
              desc: WebRTC (Discord)
              log: enable
              action: accept
            - dest_groups: resilio-sync-trackers
              # source_groups: k8s-resilio-sync-v4
              desc: Resilio-Sync Trackers
              protocol: tcp_udp
              port: 4000
              log: enable
              action: accept
            - dest_groups: resilio-sync-relays
              # source_groups: k8s-resilio-sync-v4
              desc: Resilio-Sync Relays
              protocol: tcp_udp
              port: 3000,3001
              log: enable
              action: accept
            - protocol: icmp
              log: enable
              action: accept
            - protocol: all
              log: enable
              action: reject
              # ipv6:
              #     - name: external_to_local_ipv6
              #       zones:
              #         from: external
              #         to: local
              #       rules:
              #         - source_groups: external-bgp-peers-v6
              #           protocol: tcp
              #           port: 179
              #           action: accept
              #         - protocol: icmpv6
              #           action: accept
              #         - protocol: all
              #           action: reject
              #     - name: internal_to_local_ipv6
              #       zones:
              #         from: internal
              #         to: local
              #       rules:
              #         - source_groups: internal-bgp-peers-v6
              #           protocol: tcp
              #           port: 179
              #           action: accept
              #         - protocol: ospf
              #           action: accept
              #         - protocol: icmpv6
              #           action: accept
              #         - protocol: all
              #           action: reject
              #     - name: external_to_internal_ipv6
              #       zones:
              #         from: external
              #         to: internal
              #       rules:
              #         - protocol: icmpv6
              #           action: accept
              #         - protocol: all
              #           action: reject
              #     - name: local_to_external_ipv6
              #       zones:
              #         from: local
              #         to: external
              #       rules:
              #         - dest_groups: external-bgp-peers-v6
              #           protocol: tcp
              #           port: 179
              #           action: accept
              #         - protocol: ospf
              #           action: accept
              #         - protocol: icmpv6
              #           action: accept
              #         - protocol: all
              #           action: reject
              #     - name: local_to_internal_ipv6
              #       zones:
              #         from: local
              #         to: internal
              #       rules:
              #         - dest_groups: internal-bgp-peers-v6
              #           protocol: tcp
              #           port: 179
              #           action: accept
              #         - protocol: ospf
              #           action: accept
              #         - protocol: icmpv6
              #           action: accept
              #         - protocol: all
              #           action: reject
              #     - name: internal_to_external_ipv6
              #       zones:
              #         from: internal
              #         to: external
              #       rules:
              #         - protocol: icmpv6
              #           action: accept
              #         - protocol: all
              #           action: reject